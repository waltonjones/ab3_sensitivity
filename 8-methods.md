# Materials and methods
## Fly stocks
Unless otherwise indicated, we maintained all fly stocks at 25 °C and 60% relative humidity under a 12h:12h light:dark cycle on standard cornmeal-yeast-corn syrup medium with 1.5 g/L of the anti-fungal Tegosept.
We acquired the following fly stocks from either the Bloomington _Drosophila_ Stock Center (BDSC) or the Vienna _Drosophila_ Resource Center (VDRC) for use in our experiments :  _Canton-S_ (BDSC #1), _w^1118^_ (BDSC #5905), _NPF-GAL4_ (BDSC #25681), _UAS-NPF-IR_ (VDRC #108772), _386Y-GAL4_ (BDSC #25410), _NPFR^c01896^_ (BDSC #10747), _NPFR^Def^_ (BDSC #1982), _Orco-GAL4_ (BDSC #23292), _Or22a-GAL4_  (BDSC #9951), _UAS-NPFR-IR_ (VDRC #9605).
We generated the _UAS-NPFR-RD_ and _UAS-NPFR-RB_ stocks by cloning NPFR cDNAs from _Drosophila_ heads, sub-cloning them into a pUAS-T attB-containing vector, and injecting the resulting plasmids into eggs of a fly stock containing an attP landing site flies (BDSC #9736) using standard techniques.

## Electrophysiology
We performed single sensillum electrophysiological recordings for 7--14 day old flies by inserting electrolytically sharpened tungsten electrodes into large basiconic sensilla as previously described \cite{Benton_2011ei}.
We used a universal single-ended probe, an IDAC4 data acquisition controller, a CS55 stimulus controller, and the Autospike software (Syntech, Germany).

We purchased all odors from Sigma-Aldrich (USA) at the highest purity available, suspended them in paraffin oil at the indicated dilutions, and delivered them by adding 3 µl of odor-paraffin oil emulsion to a small piece of filter paper.
These were immediately inserted into standard pasteur pipettes.
After connecting these odor cartridges in-line with the stimulus controller, we used a foot pedal to trigger 0.5 s switches between odorous and non-odorous air streams directed at the antennae of live, restrained flies.

We calculated peak odor-evoked firing rates by counting the spikes occurring in the most action potential-rich 200 ms stretch of time within a 0.5 s window after odor stimulation.
After converting this to spikes per second, we subtracted the number of spontaneous action potentials that occurred within a 1 s window before odor delivery.

## qPCR
We prepared cDNAs for qPCR by extracting total RNA from _Drosophila_ heads and reverse transcribing them with oligo(dT)20 primers and the SuperScript III First-Strand Synthesis System (Invitrogen, USA).
We then performed qPCR amplification using the TOPrealTM qPCR 2X PreMIX (Enzynomics, South Korea) and a CFX96TM Real Time System (Bio-Rad, USA).
We used RpL32 for normalization and quantified Or22a expression using the Bio-Rad CFX Manager 3.1 software package.
The primers (5' to 3') were as follows: Or22a (CGACGAACAGTTTTACATCTC, AATGCGTCAACATAGTCCAA); RpL32 (GCTAAGCTGTCGCACAAATG, CAATCTCCTTGCGCTTCTTG).

## Immunofluorescence
We performed antennal immunostaining experiments as previously described \cite{Dobritsa_2003} using a immunopurified rabbit polyclonal antibody raised against an OR22a peptide (NH2-C-MLSKFFPHIKEKPLSERVKS-COOH) \cite{Dobritsa_2003} at 1.3 µg/ml.
As a secondary antibody, we used goat anti-rabbit IgG Alexa Fluor 488 (Abcam ab150085, USA) at 1:800 v/v.

We performed whole-mount brain immunostaining experiments as previously described \cite{Vosshall_2000} using a rabbit polyclonal anti-NPF antibody (RB-19-0001, RayBiotech, USA) at 0.2 mg/ml and nc82 (AB_2314866, DSHB, USA) at 7 µg/ml.
As secondary antibodies, we used goat anti-rabbit IgG Alexa Fluor 488 and goat anti-mouse IgG Alexa Fluor 594 (A-11005, Thermofisher, USA) at 1:100 v/v.

## Behavior
For the behavioral assays, we aged flies 7--10 days on standard food and then habituated them on apple juice for 1 day.
For each genotype or condition, we introduced individual flies (n ≥ 10) into origin vials connected to bait vials by a narrow length of straw just wide enough for a single fly to pass.
Figure 5A shows a photo and a schematic of a completed olfactory trap assembly.
After aging and habituation, we placed each loaded trap assembly in a dark 25 °C incubator for 40 hours.
From 40--50 hours, we checked the assay assemblies every two hours to remove those in which the flies had moved into the bait chambers.
We used this strategy because preliminary experiments indicated the flies grow sufficiently hungry and therefore motivated to find food over the initial 40 hours of starvation.
As the results for this assay are binary (i.e., success or failure in reaching the bait), we used Fisher's exact test in our statistical analysis of the results.
